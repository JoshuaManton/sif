#include "basic.sif"
// #include "dynamic_array.sif"

// todo(josh): test what happens when caller doesn't pass parameters

struct Foo!($T: typeid, $wowza: int) {
    var data: T;
    var arr: [wowza]int;
}

proc value_poly($a: int) : int {
    return a * a;
}

proc type_poly(a: $T) : T {
    return a * a;
}

proc value_and_type_poly($a: $T) : T {
    return a * a;
}

proc thing(foo: $T) {
    print_int(foo.arr[4]);
}

proc main() {
    // var dyn: Dynamic_Array!(float);
    // dyn.append
    var poly_struct: Foo!(float, 32);
    poly_struct.arr[4] = 123;
    print_int(poly_struct.arr[4]);
    thing(poly_struct);

    print_int(value_poly(2));

    print_int(type_poly(3));
    print_float(type_poly(4.0));
    var a: int = 5;
    var f: float = 6;
    print_int(type_poly(a));
    print_float(type_poly(f));

    print_int(value_and_type_poly(7));
    print_float(value_and_type_poly(8.0));
}
